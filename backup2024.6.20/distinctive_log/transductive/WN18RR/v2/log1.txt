
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$ ./train.sh
15:38:52   Random seed: 1024
15:38:52   Config file: config/inductive/wn18rr.yaml
15:38:52   {'accuracy_threshold': 0.5,
 'dataset': {'class': 'IndWN18RR',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v2'},
 'model': {'aggregate_func': 'pna',
           'class': 'DistinctiveNBFNet',
           'dependent': False,
           'graphs': [True, True, False, False],
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'recall_threshold': 0.5,
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
Processing...
Done!
15:38:55   IndWN18RR dataset
15:38:55   #train: 15262, #valid: 1838, #test: 441
15:38:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:38:57   Epoch 0 begin
Load rspmm extension. This may take a while...
15:39:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:39:01   binary cross entropy: 0.694902
15:40:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:40:30   binary cross entropy: 0.319354
15:41:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:41:57   binary cross entropy: 0.359188
15:42:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:42:31   Epoch 0 end
15:42:31   ------------------------------
15:42:31   average binary cross entropy: 0.376561
15:42:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:42:31   Epoch 1 begin
15:43:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:43:26   binary cross entropy: 0.274518
15:44:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:44:54   binary cross entropy: 0.450689
15:46:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:46:02   Epoch 1 end
15:46:02   ------------------------------
15:46:02   average binary cross entropy: 0.336505
15:46:02   Save checkpoint to model_epoch_2.pth
15:46:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:46:02   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
15:46:21   mr: 285.415
15:46:21   mrr: 0.54532
15:46:21   hits@1: 0.466812
15:46:21   hits@3: 0.598205
15:46:21   hits@10: 0.668662
15:46:21   hits@10_50: 0.927342
15:46:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:46:21   Epoch 2 begin
15:46:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:46:41   binary cross entropy: 0.309341
15:48:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:48:10   binary cross entropy: 0.364946
15:49:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:49:39   binary cross entropy: 0.360489
15:49:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:49:52   Epoch 2 end
15:49:52   ------------------------------
15:49:52   average binary cross entropy: 0.328081
15:49:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:49:52   Epoch 3 begin
15:51:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:51:06   binary cross entropy: 0.347142
15:52:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:52:34   binary cross entropy: 0.281559
15:53:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:53:23   Epoch 3 end
15:53:23   ------------------------------
15:53:23   average binary cross entropy: 0.324045
15:53:23   Save checkpoint to model_epoch_4.pth
15:53:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:53:23   Evaluate on valid
15:53:42   mr: 268.41
15:53:42   mrr: 0.538013
15:53:42   hits@1: 0.455114
15:53:42   hits@3: 0.59494
15:53:42   hits@10: 0.670838
15:53:42   hits@10_50: 0.933743
15:53:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:53:42   Epoch 4 begin
15:54:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:54:21   binary cross entropy: 0.221466
15:55:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:55:49   binary cross entropy: 0.323412
15:57:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:57:11   Epoch 4 end
15:57:11   ------------------------------
15:57:11   average binary cross entropy: 0.3197
15:57:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:57:11   Epoch 5 begin
15:57:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:57:17   binary cross entropy: 0.363269
15:58:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:58:44   binary cross entropy: 0.256205
16:00:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:00:12   binary cross entropy: 0.409924
16:00:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:00:41   Epoch 5 end
16:00:41   ------------------------------
16:00:41   average binary cross entropy: 0.318118
16:00:41   Save checkpoint to model_epoch_6.pth
16:00:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:00:41   Evaluate on valid
16:01:00   mr: 263.936
16:01:00   mrr: 0.546173
16:01:00   hits@1: 0.464363
16:01:00   hits@3: 0.601469
16:01:00   hits@10: 0.679815
16:01:00   hits@10_50: 0.932318
16:01:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:01:00   Epoch 6 begin
16:01:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:01:59   binary cross entropy: 0.292892
16:03:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:03:27   binary cross entropy: 0.333188
16:04:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:04:30   Epoch 6 end
16:04:30   ------------------------------
16:04:30   average binary cross entropy: 0.316561
16:04:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:04:30   Epoch 7 begin
16:04:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:04:54   binary cross entropy: 0.404562
16:06:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:06:22   binary cross entropy: 0.327393
16:07:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:07:50   binary cross entropy: 0.365635
16:07:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:07:59   Epoch 7 end
16:07:59   ------------------------------
16:07:59   average binary cross entropy: 0.313607
16:07:59   Save checkpoint to model_epoch_8.pth
16:07:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:07:59   Evaluate on valid
16:08:19   mr: 270.84
16:08:19   mrr: 0.552103
16:08:19   hits@1: 0.468716
16:08:19   hits@3: 0.611806
16:08:19   hits@10: 0.687432
16:08:19   hits@10_50: 0.930923
16:08:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:08:19   Epoch 8 begin
16:09:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:09:36   binary cross entropy: 0.283637
16:11:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:11:05   binary cross entropy: 0.326498
16:11:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:11:49   Epoch 8 end
16:11:49   ------------------------------
16:11:49   average binary cross entropy: 0.311465
16:11:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:11:49   Epoch 9 begin
16:12:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:12:33   binary cross entropy: 0.263913
16:14:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:01   binary cross entropy: 0.294503
16:15:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:15:19   Epoch 9 end
16:15:19   ------------------------------
16:15:19   average binary cross entropy: 0.311796
16:15:19   Save checkpoint to model_epoch_10.pth
16:15:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:15:19   Evaluate on valid
16:15:38   mr: 279.97
16:15:38   mrr: 0.553488
16:15:38   hits@1: 0.470076
16:15:38   hits@3: 0.61099
16:15:38   hits@10: 0.692329
16:15:38   hits@10_50: 0.925658
16:15:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:15:38   Epoch 10 begin
16:15:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:15:48   binary cross entropy: 0.271546
16:17:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:17:16   binary cross entropy: 0.312683
16:18:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:18:43   binary cross entropy: 0.311204
16:19:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:19:07   Epoch 10 end
16:19:07   ------------------------------
16:19:07   average binary cross entropy: 0.3084
16:19:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:19:07   Epoch 11 begin
16:20:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:20:10   binary cross entropy: 0.339423
16:21:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:21:38   binary cross entropy: 0.360838
16:22:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:36   Epoch 11 end
16:22:36   ------------------------------
16:22:36   average binary cross entropy: 0.30882
16:22:36   Save checkpoint to model_epoch_12.pth
16:22:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:36   Evaluate on valid
16:22:55   mr: 258.726
16:22:55   mrr: 0.558491
16:22:55   hits@1: 0.475517
16:22:55   hits@3: 0.615615
16:22:55   hits@10: 0.690968
16:22:55   hits@10_50: 0.933198
16:22:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:55   Epoch 12 begin
16:23:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:23:24   binary cross entropy: 0.42815
16:24:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:24:52   binary cross entropy: 0.336989
16:26:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:26:19   binary cross entropy: 0.342141
16:26:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:26:24   Epoch 12 end
16:26:24   ------------------------------
16:26:24   average binary cross entropy: 0.308266
16:26:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:26:24   Epoch 13 begin
16:27:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:46   binary cross entropy: 0.285456
16:29:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:29:14   binary cross entropy: 0.239168
16:29:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:29:53   Epoch 13 end
16:29:53   ------------------------------
16:29:53   average binary cross entropy: 0.308844
16:29:53   Save checkpoint to model_epoch_14.pth
16:29:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:29:53   Evaluate on valid
16:30:12   mr: 251.5
16:30:12   mrr: 0.557747
16:30:12   hits@1: 0.473341
16:30:12   hits@3: 0.617519
16:30:12   hits@10: 0.692601
16:30:12   hits@10_50: 0.93692
16:30:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:12   Epoch 14 begin
16:31:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:31:01   binary cross entropy: 0.339795
16:32:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:28   binary cross entropy: 0.35008
16:33:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:33:42   Epoch 14 end
16:33:42   ------------------------------
16:33:42   average binary cross entropy: 0.306023
16:33:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:33:42   Epoch 15 begin
16:33:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:33:56   binary cross entropy: 0.325016
16:35:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:24   binary cross entropy: 0.238601
16:36:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:36:52   binary cross entropy: 0.430041
16:37:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:12   Epoch 15 end
16:37:12   ------------------------------
16:37:12   average binary cross entropy: 0.30285
16:37:12   Save checkpoint to model_epoch_16.pth
16:37:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:12   Evaluate on valid
16:37:32   mr: 261.502
16:37:32   mrr: 0.56119
16:37:32   hits@1: 0.478509
16:37:32   hits@3: 0.618335
16:37:32   hits@10: 0.696409
16:37:32   hits@10_50: 0.932157
16:37:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:32   Epoch 16 begin
16:38:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:39   binary cross entropy: 0.180359
16:40:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:08   binary cross entropy: 0.337141
16:41:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:02   Epoch 16 end
16:41:02   ------------------------------
16:41:02   average binary cross entropy: 0.305883
16:41:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:02   Epoch 17 begin
16:41:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:35   binary cross entropy: 0.305832
16:43:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:04   binary cross entropy: 0.330338
16:44:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:32   binary cross entropy: 0.219086
16:44:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:32   Epoch 17 end
16:44:32   ------------------------------
16:44:32   average binary cross entropy: 0.302706
16:44:32   Save checkpoint to model_epoch_18.pth
16:44:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:32   Evaluate on valid
16:44:51   mr: 246.907
16:44:51   mrr: 0.56047
16:44:51   hits@1: 0.478237
16:44:51   hits@3: 0.617247
16:44:51   hits@10: 0.693961
16:44:51   hits@10_50: 0.934964
16:44:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:51   Epoch 18 begin
16:46:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:46:20   binary cross entropy: 0.244916
16:47:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:49   binary cross entropy: 0.256656
16:48:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:24   Epoch 18 end
16:48:24   ------------------------------
16:48:24   average binary cross entropy: 0.302555
16:48:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:24   Epoch 19 begin
16:49:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:17   binary cross entropy: 0.218583
16:50:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:45   binary cross entropy: 0.213336
16:51:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:54   Epoch 19 end
16:51:54   ------------------------------
16:51:54   average binary cross entropy: 0.303953
16:51:54   Save checkpoint to model_epoch_20.pth
16:51:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:54   Evaluate on valid
16:52:14   mr: 257.039
16:52:14   mrr: 0.564708
16:52:14   hits@1: 0.480686
16:52:14   hits@3: 0.625408
16:52:14   hits@10: 0.697769
16:52:14   hits@10_50: 0.934773
16:52:14   Load checkpoint from model_epoch_20.pth
16:52:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:14   Evaluate on valid
16:52:33   mr: 257.039
16:52:33   mrr: 0.564708
16:52:33   hits@1: 0.480686
16:52:33   hits@3: 0.625408
16:52:33   hits@10: 0.697769
16:52:33   hits@10_50: 0.934773
16:52:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:33   Evaluate on test
16:52:36   mr: 156.561
16:52:36   mrr: 0.658231
16:52:36   hits@1: 0.573696
16:52:36   hits@3: 0.727891
16:52:36   hits@10: 0.784581
16:52:36   hits@10_50: 0.899461
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$
