/home/zhixiang/miniconda3/bin/conda run -n py38 --no-capture-output python /home/zhixiang/.pycharm_helpers/pydev/pydevd.py --multiprocess --qt-support=auto --client localhost --port 45697 --file /media/hdd/zhixiang/pycharm/NBFNet/script/run.py -c config/inductive/fb15k237.yaml --gpus [0] --version v1 
Console output is saving to: C:\Users\Zhixiang Su\PycharmProjects\console_logs\tmplog.txt
Connected to pydev debugger (build 233.14475.56)
13:35:25   Random seed: 1024
13:35:25   Config file: config/inductive/fb15k237.yaml
13:35:25   {'accuracy_threshold': 0.5,
 'dataset': {'class': 'IndFB15k-237',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v1'},
 'model': {'aggregate_func': 'pna',
           'class': 'DistinctiveNBFNet',
           'dependent': True,
           'graphs': [True, True, False, False],
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'remove_one_hop': True,
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'recall_threshold': 0.5,
 'task': {'adversarial_temperature': 0.5,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
13:35:28   IndFB15k-237 dataset
13:35:28   #train: 4245, #valid: 489, #test: 205
13:35:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:31   Epoch 0 begin
Load rspmm extension. This may take a while...
13:36:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:17   binary cross entropy: 0.699728
13:37:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:43   Epoch 0 end
13:37:43   ------------------------------
13:37:43   average binary cross entropy: 0.524253
13:37:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:43   Epoch 1 begin
13:38:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:25   binary cross entropy: 0.529068
13:39:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:06   Epoch 1 end
13:39:06   ------------------------------
13:39:06   average binary cross entropy: 0.427094
13:39:06   Save checkpoint to model_epoch_2.pth
13:39:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:06   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
13:39:18   mr: 81.9335
13:39:18   mrr: 0.468228
13:39:18   hits@1: 0.389571
13:39:18   hits@3: 0.509202
13:39:18   hits@10: 0.605317
13:39:18   hits@10_50: 0.912256
13:39:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:18   Epoch 2 begin
13:40:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:43   binary cross entropy: 0.322086
13:40:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:43   Epoch 2 end
13:40:43   ------------------------------
13:40:43   average binary cross entropy: 0.404336
13:40:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:43   Epoch 3 begin
13:42:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:42:07   Epoch 3 end
13:42:07   ------------------------------
13:42:07   average binary cross entropy: 0.382678
13:42:07   Save checkpoint to model_epoch_4.pth
13:42:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:42:07   Evaluate on valid
13:42:19   mr: 70.6759
13:42:19   mrr: 0.466533
13:42:19   hits@1: 0.381391
13:42:19   hits@3: 0.513292
13:42:19   hits@10: 0.621677
13:42:19   hits@10_50: 0.925152
13:42:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:42:19   Epoch 4 begin
13:43:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:43:01   binary cross entropy: 0.340209
13:43:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:43:43   Epoch 4 end
13:43:43   ------------------------------
13:43:43   average binary cross entropy: 0.372635
13:43:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:43:43   Epoch 5 begin
13:45:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:45:06   binary cross entropy: 0.280341
13:45:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:45:08   Epoch 5 end
13:45:08   ------------------------------
13:45:08   average binary cross entropy: 0.356632
13:45:08   Save checkpoint to model_epoch_6.pth
13:45:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:45:08   Evaluate on valid
13:45:20   mr: 69.6585
13:45:20   mrr: 0.462164
13:45:20   hits@1: 0.380368
13:45:20   hits@3: 0.507157
13:45:20   hits@10: 0.617587
13:45:20   hits@10_50: 0.921807
13:45:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:45:20   Epoch 6 begin
13:46:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:46:44   Epoch 6 end
13:46:44   ------------------------------
13:46:44   average binary cross entropy: 0.358154
13:46:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:46:44   Epoch 7 begin
13:47:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:47:26   binary cross entropy: 0.402658
13:48:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:48:09   Epoch 7 end
13:48:09   ------------------------------
13:48:09   average binary cross entropy: 0.344765
13:48:09   Save checkpoint to model_epoch_8.pth
13:48:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:48:10   Evaluate on valid
13:48:21   mr: 72.3272
13:48:21   mrr: 0.467568
13:48:21   hits@1: 0.391616
13:48:21   hits@3: 0.505112
13:48:21   hits@10: 0.608384
13:48:21   hits@10_50: 0.922976
13:48:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:48:21   Epoch 8 begin
13:49:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:49:44   binary cross entropy: 0.333555
13:49:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:49:47   Epoch 8 end
13:49:47   ------------------------------
13:49:47   average binary cross entropy: 0.33004
13:49:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:49:47   Epoch 9 begin
13:51:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:51:12   Epoch 9 end
13:51:12   ------------------------------
13:51:12   average binary cross entropy: 0.32678
13:51:12   Save checkpoint to model_epoch_10.pth
13:51:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:51:12   Evaluate on valid
13:51:24   mr: 72.7699
13:51:24   mrr: 0.470558
13:51:24   hits@1: 0.390593
13:51:24   hits@3: 0.515337
13:51:24   hits@10: 0.613497
13:51:24   hits@10_50: 0.92448
13:51:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:51:24   Epoch 10 begin
13:52:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:52:03   binary cross entropy: 0.340141
13:52:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:52:50   Epoch 10 end
13:52:50   ------------------------------
13:52:50   average binary cross entropy: 0.329392
13:52:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:52:50   Epoch 11 begin
13:54:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:54:13   binary cross entropy: 0.25985
13:54:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:54:17   Epoch 11 end
13:54:17   ------------------------------
13:54:17   average binary cross entropy: 0.308856
13:54:17   Save checkpoint to model_epoch_12.pth
13:54:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:54:17   Evaluate on valid
13:54:29   mr: 69.5501
13:54:29   mrr: 0.469684
13:54:29   hits@1: 0.387526
13:54:29   hits@3: 0.513292
13:54:29   hits@10: 0.621677
13:54:29   hits@10_50: 0.926002
13:54:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:54:29   Epoch 12 begin
13:55:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:55:53   Epoch 12 end
13:55:53   ------------------------------
13:55:53   average binary cross entropy: 0.312287
13:55:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:55:53   Epoch 13 begin
13:56:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:56:31   binary cross entropy: 0.291521
13:57:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:57:17   Epoch 13 end
13:57:17   ------------------------------
13:57:17   average binary cross entropy: 0.306049
13:57:17   Save checkpoint to model_epoch_14.pth
13:57:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:57:18   Evaluate on valid
13:57:30   mr: 74.638
13:57:30   mrr: 0.467011
13:57:30   hits@1: 0.382413
13:57:30   hits@3: 0.519427
13:57:30   hits@10: 0.618609
13:57:30   hits@10_50: 0.918449
13:57:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:57:30   Epoch 14 begin
13:58:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:58:49   binary cross entropy: 0.311413
13:58:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:58:54   Epoch 14 end
13:58:54   ------------------------------
13:58:54   average binary cross entropy: 0.296758
13:58:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:58:54   Epoch 15 begin
14:00:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:00:19   Epoch 15 end
14:00:19   ------------------------------
14:00:19   average binary cross entropy: 0.297105
14:00:19   Save checkpoint to model_epoch_16.pth
14:00:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:00:19   Evaluate on valid
14:00:32   mr: 72.3967
14:00:32   mrr: 0.469795
14:00:32   hits@1: 0.392638
14:00:32   hits@3: 0.510225
14:00:32   hits@10: 0.609407
14:00:32   hits@10_50: 0.921036
14:00:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:00:32   Epoch 16 begin
14:01:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:01:08   binary cross entropy: 0.256004
14:01:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:01:57   Epoch 16 end
14:01:57   ------------------------------
14:01:57   average binary cross entropy: 0.296008
14:01:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:01:57   Epoch 17 begin
14:03:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:03:15   binary cross entropy: 0.343606
14:03:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:03:21   Epoch 17 end
14:03:21   ------------------------------
14:03:21   average binary cross entropy: 0.285594
14:03:21   Save checkpoint to model_epoch_18.pth
14:03:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:03:22   Evaluate on valid
14:03:34   mr: 75.6432
14:03:34   mrr: 0.469801
14:03:34   hits@1: 0.388548
14:03:34   hits@3: 0.518405
14:03:34   hits@10: 0.613497
14:03:34   hits@10_50: 0.916435
14:03:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:03:34   Epoch 18 begin
14:04:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:04:58   Epoch 18 end
14:04:58   ------------------------------
14:04:58   average binary cross entropy: 0.282688
14:04:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:04:58   Epoch 19 begin
14:05:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:05:33   binary cross entropy: 0.210366
14:06:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:06:22   Epoch 19 end
14:06:22   ------------------------------
14:06:22   average binary cross entropy: 0.276305
14:06:22   Save checkpoint to model_epoch_20.pth
14:06:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:06:22   Evaluate on valid
14:06:35   mr: 77.0317
14:06:35   mrr: 0.470512
14:06:35   hits@1: 0.395706
14:06:35   hits@3: 0.510225
14:06:35   hits@10: 0.60225
14:06:35   hits@10_50: 0.915055
14:06:35   Load checkpoint from model_epoch_10.pth
14:06:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:06:35   Evaluate on valid
14:06:48   mr: 72.7699
14:06:48   mrr: 0.470558
14:06:48   hits@1: 0.390593
14:06:48   hits@3: 0.515337
14:06:48   hits@10: 0.613497
14:06:48   hits@10_50: 0.92448
14:06:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:06:48   Evaluate on test
14:06:53   mr: 125.039
14:06:53   mrr: 0.445528
14:06:53   hits@1: 0.356098
14:06:53   hits@3: 0.5
14:06:53   hits@10: 0.582927
14:06:53   hits@10_50: 0.83579

Process finished with exit code 0
