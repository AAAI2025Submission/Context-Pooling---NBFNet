
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$ ./train.sh
18:52:05   Random seed: 1024
18:52:05   Config file: config/inductive/fb15k237.yaml
18:52:05   {'dataset': {'class': 'IndFB15k-237',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v3'},
 'model': {'aggregate_func': 'pna',
           'class': 'DistinctiveNBFNet',
           'dependent': True,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'remove_one_hop': True,
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 0.5,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 4,
           'gpus': [0],
           'log_interval': 10000,
           'num_epoch': 20}}
18:52:08   IndFB15k-237 dataset
18:52:08   #train: 17986, #valid: 2194, #test: 865
18:52:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:52:10   Epoch 0 begin
Load rspmm extension. This may take a while...
18:52:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:52:15   binary cross entropy: 0.691043
19:43:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:43:19   Epoch 0 end
19:43:19   ------------------------------
19:43:19   average binary cross entropy: 0.454863
19:43:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:43:19   Epoch 1 begin
20:31:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:31:51   Epoch 1 end
20:31:51   ------------------------------
20:31:51   average binary cross entropy: 0.405067
20:31:51   Save checkpoint to model_epoch_2.pth
20:31:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:31:53   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
20:37:23   mr: 107.366
20:37:23   mrr: 0.386172
20:37:23   hits@1: 0.282133
20:37:23   hits@3: 0.443482
20:37:23   hits@10: 0.581814
20:37:23   hits@10_50: 0.95711
20:37:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:37:23   Epoch 2 begin
20:48:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:48:26   binary cross entropy: 0.495294
21:25:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:25:54   Epoch 2 end
21:25:54   ------------------------------
21:25:54   average binary cross entropy: 0.388375
21:25:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:25:54   Epoch 3 begin
22:17:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:17:34   Epoch 3 end
22:17:34   ------------------------------
22:17:34   average binary cross entropy: 0.383219
22:17:34   Save checkpoint to model_epoch_4.pth
22:17:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:17:34   Evaluate on valid
22:23:00   mr: 117.388
22:23:00   mrr: 0.388896
22:23:00   hits@1: 0.286007
22:23:00   hits@3: 0.441203
22:23:00   hits@10: 0.588879
22:23:00   hits@10_50: 0.945284
22:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:23:00   Epoch 4 begin
22:44:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:44:53   binary cross entropy: 0.38672
23:11:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:31   Epoch 4 end
23:11:31   ------------------------------
23:11:31   average binary cross entropy: 0.383891
23:11:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:31   Epoch 5 begin
00:03:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:03:53   Epoch 5 end
00:03:53   ------------------------------
00:03:53   average binary cross entropy: 0.374888
00:03:53   Save checkpoint to model_epoch_6.pth
00:03:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:03:54   Evaluate on valid
00:09:30   mr: 120.747
00:09:30   mrr: 0.376559
00:09:30   hits@1: 0.265041
00:09:30   hits@3: 0.435506
00:09:30   hits@10: 0.596171
00:09:30   hits@10_50: 0.935357
00:09:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:09:30   Epoch 6 begin
00:42:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:42:46   binary cross entropy: 0.448023
00:59:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:59:01   Epoch 6 end
00:59:01   ------------------------------
00:59:01   average binary cross entropy: 0.379277
00:59:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:59:01   Epoch 7 begin
01:51:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:51:09   Epoch 7 end
01:51:09   ------------------------------
01:51:09   average binary cross entropy: 0.370049
01:51:09   Save checkpoint to model_epoch_8.pth
01:51:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:51:10   Evaluate on valid
01:56:39   mr: 120.544
01:56:39   mrr: 0.376813
01:56:39   hits@1: 0.26299
01:56:39   hits@3: 0.439608
01:56:39   hits@10: 0.594348
01:56:39   hits@10_50: 0.949654
01:56:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:56:39   Epoch 8 begin
02:40:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:40:28   binary cross entropy: 0.60015
02:45:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:45:39   Epoch 8 end
02:45:39   ------------------------------
02:45:39   average binary cross entropy: 0.374424
02:45:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:45:39   Epoch 9 begin
03:34:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:34:06   Epoch 9 end
03:34:06   ------------------------------
03:34:06   average binary cross entropy: 0.369797
03:34:06   Save checkpoint to model_epoch_10.pth
03:34:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:34:06   Evaluate on valid
03:39:28   mr: 108.748
03:39:28   mrr: 0.386313
03:39:28   hits@1: 0.278031
03:39:28   hits@3: 0.444394
03:39:28   hits@10: 0.596399
03:39:28   hits@10_50: 0.956993
03:39:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:39:28   Epoch 10 begin
04:30:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:30:29   Epoch 10 end
04:30:29   ------------------------------
04:30:29   average binary cross entropy: 0.365769
04:30:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:30:29   Epoch 11 begin
04:36:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:36:06   binary cross entropy: 0.333122
05:18:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:18:13   Epoch 11 end
05:18:13   ------------------------------
05:18:13   average binary cross entropy: 0.365601
05:18:13   Save checkpoint to model_epoch_12.pth
05:18:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:18:13   Evaluate on valid
05:23:39   mr: 111.882
05:23:39   mrr: 0.376975
05:23:39   hits@1: 0.26618
05:23:39   hits@3: 0.432771
05:23:39   hits@10: 0.58979
05:23:39   hits@10_50: 0.952248
05:23:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:23:39   Epoch 12 begin
06:14:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:14:47   Epoch 12 end
06:14:47   ------------------------------
06:14:47   average binary cross entropy: 0.36421
06:14:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:14:47   Epoch 13 begin
06:26:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:26:10   binary cross entropy: 0.473035
06:48:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:48:18   Epoch 13 end
06:48:18   ------------------------------
06:48:18   average binary cross entropy: 0.36076
06:48:18   Save checkpoint to model_epoch_14.pth
06:48:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:48:18   Evaluate on valid
06:52:15   mr: 119.092
06:52:15   mrr: 0.367509
06:52:15   hits@1: 0.255469
06:52:15   hits@3: 0.424795
06:52:15   hits@10: 0.589107
06:52:15   hits@10_50: 0.950867
06:52:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:52:15   Epoch 14 begin
07:26:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
07:26:09   Epoch 14 end
07:26:09   ------------------------------
07:26:09   average binary cross entropy: 0.360885
07:26:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
07:26:09   Epoch 15 begin
07:44:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
07:44:50   binary cross entropy: 0.158393
07:59:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
07:59:03   Epoch 15 end
07:59:03   ------------------------------
07:59:03   average binary cross entropy: 0.364836
07:59:03   Save checkpoint to model_epoch_16.pth
07:59:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
07:59:03   Evaluate on valid
08:02:58   mr: 210.636
08:02:58   mrr: 0.375748
08:02:58   hits@1: 0.269143
08:02:58   hits@3: 0.434366
08:02:58   hits@10: 0.580675
08:02:58   hits@10_50: 0.910456
08:02:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
08:02:58   Epoch 16 begin
08:35:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
08:35:41   Epoch 16 end
08:35:41   ------------------------------
08:35:41   average binary cross entropy: 0.3723
08:35:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
08:35:41   Epoch 17 begin
09:01:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:01:31   binary cross entropy: 0.205489
09:08:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:08:23   Epoch 17 end
09:08:23   ------------------------------
09:08:23   average binary cross entropy: 0.36522
09:08:23   Save checkpoint to model_epoch_18.pth
09:08:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:08:23   Evaluate on valid
09:12:18   mr: 172.287
09:12:18   mrr: 0.333622
09:12:18   hits@1: 0.218551
09:12:18   hits@3: 0.386737
09:12:18   hits@10: 0.566773
09:12:18   hits@10_50: 0.923982
09:12:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:12:18   Epoch 18 begin
09:45:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:45:14   Epoch 18 end
09:45:14   ------------------------------
09:45:14   average binary cross entropy: 0.371726
09:45:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
09:45:14   Epoch 19 begin
10:18:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
10:18:00   Epoch 19 end
10:18:00   ------------------------------
10:18:00   average binary cross entropy: 0.365048
10:18:00   Save checkpoint to model_epoch_20.pth
10:18:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
10:18:00   Evaluate on valid
10:24:40   mr: 121.466
10:24:40   mrr: 0.361909
10:24:40   hits@1: 0.254102
10:24:40   hits@3: 0.409526
10:24:40   hits@10: 0.581586
10:24:40   hits@10_50: 0.948029
10:24:40   Load checkpoint from model_epoch_4.pth
10:24:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
10:24:41   Evaluate on valid
10:33:35   mr: 117.388
10:33:35   mrr: 0.388896
10:33:35   hits@1: 0.286007
10:33:35   hits@3: 0.441203
10:33:35   hits@10: 0.588879
10:33:35   hits@10_50: 0.945284
10:33:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
10:33:35   Evaluate on test
10:36:46   mr: 103.135
10:36:46   mrr: 0.428957
10:36:46   hits@1: 0.316763
10:36:46   hits@3: 0.488439
10:36:47   hits@10: 0.63815
10:36:47   hits@10_50: 0.929125
{'mrr': tensor(0.4290, device='cuda:0'), 'metrics': {'mr': tensor(103.1353, device='cuda:0'), 'mrr': tensor(0.4290, device='cuda:0'), 'hits@1': tensor(0.3168, device='cuda:0'), 'hits@3': tensor(0.4884, device='cuda:0'), 'hits@10': tensor(0.6382, device='cuda:0'), 'hits@10_50': tensor(0.9291, device='cuda:0')}, 'opts': {'tuning': False, 'opts.accuracy_threshold': 0.5, 'opts.recall_threshold': 0.5, 'opts.accuracy_graph': True, 'opts.recall_graph': True, 'opts.accuracy_graph_complement': True, 'opts.recall_graph_complement': True}}
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$
