
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$ ./train.sh
14:52:48   Random seed: 1024
14:52:48   Config file: config/inductive/wn18rr.yaml
14:52:48   {'accuracy_threshold': 0.5,
 'dataset': {'class': 'IndWN18RR',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v1'},
 'model': {'aggregate_func': 'pna',
           'class': 'DistinctiveNBFNet',
           'dependent': False,
           'graphs': [True, True, False, False],
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'recall_threshold': 0.5,
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
Processing...
Done!
14:52:52   IndWN18RR dataset
14:52:52   #train: 5410, #valid: 630, #test: 188
14:52:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:52:55   Epoch 0 begin
Load rspmm extension. This may take a while...
14:52:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:52:59   binary cross entropy: 0.698927
14:55:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:55:01   Epoch 0 end
14:55:01   ------------------------------
14:55:01   average binary cross entropy: 0.429698
14:55:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:55:01   Epoch 1 begin
14:55:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:55:24   binary cross entropy: 0.365066
14:57:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:57:05   Epoch 1 end
14:57:05   ------------------------------
14:57:05   average binary cross entropy: 0.384849
14:57:05   Save checkpoint to model_epoch_2.pth
14:57:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:57:05   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
14:57:21   mr: 145.094
14:57:21   mrr: 0.51874
14:57:21   hits@1: 0.446825
14:57:21   hits@3: 0.564286
14:57:21   hits@10: 0.638095
14:57:21   hits@10_50: 0.902258
14:57:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:57:21   Epoch 2 begin
14:58:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:58:07   binary cross entropy: 0.373135
14:59:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:59:25   Epoch 2 end
14:59:25   ------------------------------
14:59:25   average binary cross entropy: 0.372927
14:59:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
14:59:25   Epoch 3 begin
15:00:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:00:32   binary cross entropy: 0.455265
15:01:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:01:29   Epoch 3 end
15:01:29   ------------------------------
15:01:29   average binary cross entropy: 0.369428
15:01:29   Save checkpoint to model_epoch_4.pth
15:01:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:01:29   Evaluate on valid
15:01:45   mr: 129.815
15:01:46   mrr: 0.536548
15:01:46   hits@1: 0.454762
15:01:46   hits@3: 0.593651
15:01:46   hits@10: 0.660317
15:01:46   hits@10_50: 0.911165
15:01:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:01:46   Epoch 4 begin
15:03:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:03:14   binary cross entropy: 0.395483
15:03:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:03:49   Epoch 4 end
15:03:49   ------------------------------
15:03:49   average binary cross entropy: 0.366736
15:03:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:03:49   Epoch 5 begin
15:05:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:05:41   binary cross entropy: 0.406316
15:05:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:05:54   Epoch 5 end
15:05:54   ------------------------------
15:05:54   average binary cross entropy: 0.365787
15:05:54   Save checkpoint to model_epoch_6.pth
15:05:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:05:54   Evaluate on valid
15:06:11   mr: 120.799
15:06:11   mrr: 0.540031
15:06:11   hits@1: 0.465873
15:06:11   hits@3: 0.589683
15:06:11   hits@10: 0.653968
15:06:11   hits@10_50: 0.918357
15:06:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:06:11   Epoch 6 begin
15:08:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:08:15   Epoch 6 end
15:08:15   ------------------------------
15:08:15   average binary cross entropy: 0.359941
15:08:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:08:15   Epoch 7 begin
15:08:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:08:24   binary cross entropy: 0.289158
15:10:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:10:19   Epoch 7 end
15:10:19   ------------------------------
15:10:19   average binary cross entropy: 0.359516
15:10:19   Save checkpoint to model_epoch_8.pth
15:10:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:10:19   Evaluate on valid
15:10:36   mr: 125.275
15:10:36   mrr: 0.534905
15:10:36   hits@1: 0.451587
15:10:36   hits@3: 0.594444
15:10:36   hits@10: 0.665079
15:10:36   hits@10_50: 0.917419
15:10:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:10:36   Epoch 8 begin
15:11:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:11:06   binary cross entropy: 0.355589
15:12:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:12:40   Epoch 8 end
15:12:40   ------------------------------
15:12:40   average binary cross entropy: 0.355106
15:12:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:12:40   Epoch 9 begin
15:13:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:13:33   binary cross entropy: 0.388691
15:14:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:14:45   Epoch 9 end
15:14:45   ------------------------------
15:14:45   average binary cross entropy: 0.355604
15:14:45   Save checkpoint to model_epoch_10.pth
15:14:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:14:45   Evaluate on valid
15:15:01   mr: 121.636
15:15:01   mrr: 0.546408
15:15:01   hits@1: 0.469048
15:15:01   hits@3: 0.603175
15:15:01   hits@10: 0.663492
15:15:01   hits@10_50: 0.919512
15:15:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:15:01   Epoch 10 begin
15:16:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:16:17   binary cross entropy: 0.31228
15:17:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:17:06   Epoch 10 end
15:17:06   ------------------------------
15:17:06   average binary cross entropy: 0.355102
15:17:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:17:06   Epoch 11 begin
15:18:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:18:44   binary cross entropy: 0.347346
15:19:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:19:12   Epoch 11 end
15:19:12   ------------------------------
15:19:12   average binary cross entropy: 0.35139
15:19:12   Save checkpoint to model_epoch_12.pth
15:19:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:19:12   Evaluate on valid
15:19:28   mr: 120.987
15:19:28   mrr: 0.539612
15:19:28   hits@1: 0.457143
15:19:28   hits@3: 0.599206
15:19:28   hits@10: 0.666667
15:19:28   hits@10_50: 0.918438
15:19:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:19:28   Epoch 12 begin
15:21:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:21:26   binary cross entropy: 0.357077
15:21:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:21:31   Epoch 12 end
15:21:31   ------------------------------
15:21:31   average binary cross entropy: 0.347725
15:21:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:21:31   Epoch 13 begin
15:23:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:07   Epoch 13 end
15:23:07   ------------------------------
15:23:07   average binary cross entropy: 0.349826
15:23:07   Save checkpoint to model_epoch_14.pth
15:23:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:08   Evaluate on valid
15:23:11   mr: 121.601
15:23:11   mrr: 0.541117
15:23:11   hits@1: 0.459524
15:23:11   hits@3: 0.597619
15:23:11   hits@10: 0.663492
15:23:11   hits@10_50: 0.92164
15:23:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:11   Epoch 14 begin
15:23:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:16   binary cross entropy: 0.350615
15:23:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:46   Epoch 14 end
15:23:46   ------------------------------
15:23:46   average binary cross entropy: 0.347131
15:23:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:46   Epoch 15 begin
15:23:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:23:57   binary cross entropy: 0.269114
15:24:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:20   Epoch 15 end
15:24:20   ------------------------------
15:24:20   average binary cross entropy: 0.343243
15:24:20   Save checkpoint to model_epoch_16.pth
15:24:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:20   Evaluate on valid
15:24:24   mr: 129.56
15:24:24   mrr: 0.543264
15:24:24   hits@1: 0.462698
15:24:24   hits@3: 0.600794
15:24:24   hits@10: 0.665873
15:24:24   hits@10_50: 0.915839
15:24:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:24   Epoch 16 begin
15:24:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:41   binary cross entropy: 0.300613
15:24:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:59   Epoch 16 end
15:24:59   ------------------------------
15:24:59   average binary cross entropy: 0.344367
15:24:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:24:59   Epoch 17 begin
15:25:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:25:22   binary cross entropy: 0.408843
15:25:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:25:33   Epoch 17 end
15:25:33   ------------------------------
15:25:33   average binary cross entropy: 0.340608
15:25:33   Save checkpoint to model_epoch_18.pth
15:25:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:25:33   Evaluate on valid
15:25:37   mr: 128.163
15:25:37   mrr: 0.551933
15:25:37   hits@1: 0.478571
15:25:37   hits@3: 0.603968
15:25:37   hits@10: 0.668254
15:25:37   hits@10_50: 0.91235
15:25:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:25:37   Epoch 18 begin
15:26:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:07   binary cross entropy: 0.34445
15:26:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:12   Epoch 18 end
15:26:12   ------------------------------
15:26:12   average binary cross entropy: 0.33917
15:26:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:12   Epoch 19 begin
15:26:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:47   Epoch 19 end
15:26:47   ------------------------------
15:26:47   average binary cross entropy: 0.341647
15:26:47   Save checkpoint to model_epoch_20.pth
15:26:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:47   Evaluate on valid
15:26:51   mr: 126.059
15:26:51   mrr: 0.549177
15:26:51   hits@1: 0.472222
15:26:51   hits@3: 0.602381
15:26:51   hits@10: 0.669048
15:26:51   hits@10_50: 0.913046
15:26:51   Load checkpoint from model_epoch_18.pth
15:26:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:51   Evaluate on valid
15:26:55   mr: 128.163
15:26:55   mrr: 0.551933
15:26:55   hits@1: 0.478571
15:26:55   hits@3: 0.603968
15:26:55   hits@10: 0.668254
15:26:55   hits@10_50: 0.91235
15:26:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
15:26:55   Evaluate on test
15:26:55   mr: 31.2021
15:26:55   mrr: 0.706354
15:26:55   hits@1: 0.62234
15:26:55   hits@3: 0.773936
15:26:55   hits@10: 0.824468
15:26:55   hits@10_50: 0.945045
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$
