/home/zhixiang/miniconda3/bin/conda run -n py38 --no-capture-output python /media/hdd/zhixiang/pycharm/NBFNet/script/run.py -c config/inductive/fb15k237.yaml --gpus [0] --version v2
Console output is saving to: C:\Users\Zhixiang Su\PycharmProjects\console_logs\tmplog.txt
13:33:17   Random seed: 1024
13:33:17   Config file: config/inductive/fb15k237.yaml
13:33:17   {'dataset': {'class': 'IndFB15k-237',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v2'},
 'model': {'aggregate_func': 'pna',
           'class': 'NBFNet',
           'dependent': True,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'remove_one_hop': True,
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 0.5,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
13:33:17   IndFB15k-237 dataset
13:33:17   #train: 9739, #valid: 1166, #test: 478
13:33:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:19   Epoch 0 begin
Load rspmm extension. This may take a while...
13:33:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:23   binary cross entropy: 0.7017
13:33:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:36   binary cross entropy: 0.565283
13:33:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:43   Epoch 0 end
13:33:43   ------------------------------
13:33:43   average binary cross entropy: 0.514438
13:33:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:43   Epoch 1 begin
13:33:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:33:49   binary cross entropy: 0.460751
13:34:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:02   binary cross entropy: 0.408557
13:34:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:03   Epoch 1 end
13:34:03   ------------------------------
13:34:03   average binary cross entropy: 0.45322
13:34:03   Save checkpoint to model_epoch_2.pth
13:34:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:03   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
13:34:04   mr: 73.2093
13:34:04   mrr: 0.349946
13:34:04   hits@1: 0.23928
13:34:04   hits@3: 0.396655
13:34:04   hits@10: 0.576329
13:34:04   hits@10_50: 0.959977
13:34:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:04   Epoch 2 begin
13:34:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:17   binary cross entropy: 0.415467
13:34:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:24   Epoch 2 end
13:34:24   ------------------------------
13:34:24   average binary cross entropy: 0.43393
13:34:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:24   Epoch 3 begin
13:34:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:30   binary cross entropy: 0.43574
13:34:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:43   binary cross entropy: 0.420103
13:34:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:44   Epoch 3 end
13:34:44   ------------------------------
13:34:44   average binary cross entropy: 0.416305
13:34:44   Save checkpoint to model_epoch_4.pth
13:34:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:44   Evaluate on valid
13:34:46   mr: 231.301
13:34:46   mrr: 0.292713
13:34:46   hits@1: 0.216552
13:34:46   hits@3: 0.317753
13:34:46   hits@10: 0.433533
13:34:46   hits@10_50: 0.856908
13:34:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:46   Epoch 4 begin
13:34:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:34:57   binary cross entropy: 0.40632
13:35:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:06   Epoch 4 end
13:35:06   ------------------------------
13:35:06   average binary cross entropy: 0.407733
13:35:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:06   Epoch 5 begin
13:35:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:10   binary cross entropy: 0.463305
13:35:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:23   binary cross entropy: 0.444692
13:35:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:25   Epoch 5 end
13:35:25   ------------------------------
13:35:25   average binary cross entropy: 0.39816
13:35:25   Save checkpoint to model_epoch_6.pth
13:35:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:25   Evaluate on valid
13:35:27   mr: 194.497
13:35:27   mrr: 0.293401
13:35:27   hits@1: 0.21741
13:35:27   hits@3: 0.319897
13:35:27   hits@10: 0.43482
13:35:27   hits@10_50: 0.874563
13:35:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:27   Epoch 6 begin
13:35:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:38   binary cross entropy: 0.355364
13:35:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:47   Epoch 6 end
13:35:47   ------------------------------
13:35:47   average binary cross entropy: 0.392042
13:35:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:47   Epoch 7 begin
13:35:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:35:51   binary cross entropy: 0.333016
13:36:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:04   binary cross entropy: 0.410854
13:36:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:07   Epoch 7 end
13:36:07   ------------------------------
13:36:07   average binary cross entropy: 0.387757
13:36:07   Save checkpoint to model_epoch_8.pth
13:36:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:07   Evaluate on valid
13:36:09   mr: 304.158
13:36:09   mrr: 0.277563
13:36:09   hits@1: 0.203688
13:36:09   hits@3: 0.311321
13:36:09   hits@10: 0.411235
13:36:09   hits@10_50: 0.823197
13:36:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:09   Epoch 8 begin
13:36:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:19   binary cross entropy: 0.419441
13:36:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:29   Epoch 8 end
13:36:29   ------------------------------
13:36:29   average binary cross entropy: 0.382944
13:36:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:29   Epoch 9 begin
13:36:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:32   binary cross entropy: 0.428619
13:36:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:45   binary cross entropy: 0.407159
13:36:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:49   Epoch 9 end
13:36:49   ------------------------------
13:36:49   average binary cross entropy: 0.372077
13:36:49   Save checkpoint to model_epoch_10.pth
13:36:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:49   Evaluate on valid
13:36:51   mr: 295.808
13:36:51   mrr: 0.275293
13:36:51   hits@1: 0.203259
13:36:51   hits@3: 0.3006
13:36:51   hits@10: 0.406089
13:36:51   hits@10_50: 0.822261
13:36:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:36:51   Epoch 10 begin
13:37:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:00   binary cross entropy: 0.409376
13:37:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:11   Epoch 10 end
13:37:11   ------------------------------
13:37:11   average binary cross entropy: 0.369138
13:37:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:11   Epoch 11 begin
13:37:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:13   binary cross entropy: 0.331824
13:37:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:26   binary cross entropy: 0.34257
13:37:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:31   Epoch 11 end
13:37:31   ------------------------------
13:37:31   average binary cross entropy: 0.362162
13:37:31   Save checkpoint to model_epoch_12.pth
13:37:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:31   Evaluate on valid
13:37:33   mr: 285.177
13:37:33   mrr: 0.274738
13:37:33   hits@1: 0.202401
13:37:33   hits@3: 0.303602
13:37:33   hits@10: 0.411664
13:37:33   hits@10_50: 0.831294
13:37:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:33   Epoch 12 begin
13:37:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:41   binary cross entropy: 0.304102
13:37:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:52   Epoch 12 end
13:37:52   ------------------------------
13:37:52   average binary cross entropy: 0.354891
13:37:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:52   Epoch 13 begin
13:37:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:37:54   binary cross entropy: 0.338327
13:38:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:07   binary cross entropy: 0.324057
13:38:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:12   Epoch 13 end
13:38:12   ------------------------------
13:38:12   average binary cross entropy: 0.351423
13:38:12   Save checkpoint to model_epoch_14.pth
13:38:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:12   Evaluate on valid
13:38:14   mr: 257.741
13:38:14   mrr: 0.273628
13:38:14   hits@1: 0.200686
13:38:14   hits@3: 0.303602
13:38:14   hits@10: 0.403516
13:38:14   hits@10_50: 0.826408
13:38:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:14   Epoch 14 begin
13:38:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:22   binary cross entropy: 0.421765
13:38:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:34   Epoch 14 end
13:38:34   ------------------------------
13:38:34   average binary cross entropy: 0.35069
13:38:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:34   Epoch 15 begin
13:38:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:34   binary cross entropy: 0.272271
13:38:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:47   binary cross entropy: 0.362414
13:38:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:53   Epoch 15 end
13:38:53   ------------------------------
13:38:53   average binary cross entropy: 0.337206
13:38:53   Save checkpoint to model_epoch_16.pth
13:38:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:54   Evaluate on valid
13:38:55   mr: 325.865
13:38:55   mrr: 0.272433
13:38:55   hits@1: 0.201973
13:38:55   hits@3: 0.299743
13:38:55   hits@10: 0.404374
13:38:55   hits@10_50: 0.807622
13:38:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:38:55   Epoch 16 begin
13:39:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:02   binary cross entropy: 0.273531
13:39:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:15   binary cross entropy: 0.296212
13:39:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:15   Epoch 16 end
13:39:15   ------------------------------
13:39:15   average binary cross entropy: 0.332036
13:39:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:15   Epoch 17 begin
13:39:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:29   binary cross entropy: 0.374916
13:39:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:36   Epoch 17 end
13:39:36   ------------------------------
13:39:36   average binary cross entropy: 0.332288
13:39:36   Save checkpoint to model_epoch_18.pth
13:39:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:36   Evaluate on valid
13:39:38   mr: 273.849
13:39:38   mrr: 0.282044
13:39:38   hits@1: 0.212264
13:39:38   hits@3: 0.307033
13:39:38   hits@10: 0.411664
13:39:38   hits@10_50: 0.833861
13:39:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:38   Epoch 18 begin
13:39:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:44   binary cross entropy: 0.285166
13:39:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:57   binary cross entropy: 0.315047
13:39:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:58   Epoch 18 end
13:39:58   ------------------------------
13:39:58   average binary cross entropy: 0.316001
13:39:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:39:58   Epoch 19 begin
13:40:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:10   binary cross entropy: 0.384072
13:40:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:18   Epoch 19 end
13:40:18   ------------------------------
13:40:18   average binary cross entropy: 0.315496
13:40:18   Save checkpoint to model_epoch_20.pth
13:40:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:18   Evaluate on valid
13:40:20   mr: 406.555
13:40:20   mrr: 0.275075
13:40:20   hits@1: 0.210549
13:40:20   hits@3: 0.301029
13:40:20   hits@10: 0.391081
13:40:20   hits@10_50: 0.78076
13:40:20   Load checkpoint from model_epoch_2.pth
13:40:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:20   Evaluate on valid
13:40:22   mr: 73.2093
13:40:22   mrr: 0.349946
13:40:22   hits@1: 0.23928
13:40:22   hits@3: 0.396655
13:40:22   hits@10: 0.576329
13:40:22   hits@10_50: 0.959977
13:40:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:40:22   Evaluate on test
13:40:22   mr: 59.0805
13:40:22   mrr: 0.353822
13:40:22   hits@1: 0.207113
13:40:22   hits@3: 0.429916
13:40:22   hits@10: 0.654812
13:40:22   hits@10_50: 0.949234

Process finished with exit code 0
