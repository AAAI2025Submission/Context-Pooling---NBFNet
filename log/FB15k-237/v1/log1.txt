/home/zhixiang/miniconda3/bin/conda run -n py38 --no-capture-output python /media/hdd/zhixiang/pycharm/NBFNet/script/run.py -c config/inductive/fb15k237.yaml --gpus [0] --version v1
Console output is saving to: C:\Users\Zhixiang Su\PycharmProjects\console_logs\tmplog.txt
18:24:59   Random seed: 1024
18:24:59   Config file: config/inductive/fb15k237.yaml
18:24:59   {'dataset': {'class': 'IndFB15k-237',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v1'},
 'model': {'aggregate_func': 'pna',
           'class': 'NBFNet',
           'dependent': True,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'remove_one_hop': True,
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 0.5,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/fb237_v1_ind/train.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/fb237_v1_ind/test.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/fb237_v1/train.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/fb237_v1/valid.txt
Processing...
Done!
18:25:01   IndFB15k-237 dataset
18:25:01   #train: 4245, #valid: 489, #test: 205
18:25:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:03   Epoch 0 begin
Load rspmm extension. This may take a while...
18:25:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:06   binary cross entropy: 0.73224
18:25:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:14   Epoch 0 end
18:25:14   ------------------------------
18:25:14   average binary cross entropy: 0.581834
18:25:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:14   Epoch 1 begin
18:25:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:18   binary cross entropy: 0.496745
18:25:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:22   Epoch 1 end
18:25:22   ------------------------------
18:25:22   average binary cross entropy: 0.482004
18:25:22   Save checkpoint to model_epoch_2.pth
18:25:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:22   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
18:25:23   mr: 95.3957
18:25:23   mrr: 0.338781
18:25:23   hits@1: 0.262781
18:25:23   hits@3: 0.357873
18:25:23   hits@10: 0.494888
18:25:23   hits@10_50: 0.896194
18:25:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:23   Epoch 2 begin
18:25:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:30   binary cross entropy: 0.418978
18:25:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:30   Epoch 2 end
18:25:30   ------------------------------
18:25:30   average binary cross entropy: 0.462684
18:25:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:30   Epoch 3 begin
18:25:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:38   Epoch 3 end
18:25:38   ------------------------------
18:25:38   average binary cross entropy: 0.444502
18:25:38   Save checkpoint to model_epoch_4.pth
18:25:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:38   Evaluate on valid
18:25:39   mr: 87.7423
18:25:39   mrr: 0.347995
18:25:39   hits@1: 0.268916
18:25:39   hits@3: 0.370143
18:25:39   hits@10: 0.523517
18:25:39   hits@10_50: 0.903214
18:25:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:39   Epoch 4 begin
18:25:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:43   binary cross entropy: 0.351844
18:25:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:47   Epoch 4 end
18:25:47   ------------------------------
18:25:47   average binary cross entropy: 0.429991
18:25:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:47   Epoch 5 begin
18:25:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:54   binary cross entropy: 0.340137
18:25:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:54   Epoch 5 end
18:25:54   ------------------------------
18:25:54   average binary cross entropy: 0.420831
18:25:54   Save checkpoint to model_epoch_6.pth
18:25:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:54   Evaluate on valid
18:25:55   mr: 85.0767
18:25:55   mrr: 0.351705
18:25:55   hits@1: 0.273006
18:25:55   hits@3: 0.371166
18:25:55   hits@10: 0.52454
18:25:55   hits@10_50: 0.914031
18:25:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:25:55   Epoch 6 begin
18:26:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:03   Epoch 6 end
18:26:03   ------------------------------
18:26:03   average binary cross entropy: 0.423862
18:26:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:03   Epoch 7 begin
18:26:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:07   binary cross entropy: 0.390209
18:26:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:11   Epoch 7 end
18:26:11   ------------------------------
18:26:11   average binary cross entropy: 0.410121
18:26:11   Save checkpoint to model_epoch_8.pth
18:26:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:11   Evaluate on valid
18:26:12   mr: 99.6104
18:26:12   mrr: 0.335775
18:26:12   hits@1: 0.259714
18:26:12   hits@3: 0.357873
18:26:12   hits@10: 0.49182
18:26:12   hits@10_50: 0.893456
18:26:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:12   Epoch 8 begin
18:26:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:19   binary cross entropy: 0.419166
18:26:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:19   Epoch 8 end
18:26:19   ------------------------------
18:26:19   average binary cross entropy: 0.397028
18:26:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:19   Epoch 9 begin
18:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:27   Epoch 9 end
18:26:27   ------------------------------
18:26:27   average binary cross entropy: 0.394393
18:26:27   Save checkpoint to model_epoch_10.pth
18:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:27   Evaluate on valid
18:26:28   mr: 107.64
18:26:28   mrr: 0.327788
18:26:28   hits@1: 0.250511
18:26:28   hits@3: 0.353783
18:26:28   hits@10: 0.47955
18:26:28   hits@10_50: 0.893589
18:26:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:28   Epoch 10 begin
18:26:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:32   binary cross entropy: 0.374237
18:26:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:36   Epoch 10 end
18:26:36   ------------------------------
18:26:36   average binary cross entropy: 0.398869
18:26:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:36   Epoch 11 begin
18:26:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:43   binary cross entropy: 0.368544
18:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:44   Epoch 11 end
18:26:44   ------------------------------
18:26:44   average binary cross entropy: 0.37902
18:26:44   Save checkpoint to model_epoch_12.pth
18:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:44   Evaluate on valid
18:26:44   mr: 112.093
18:26:44   mrr: 0.322379
18:26:44   hits@1: 0.252556
18:26:44   hits@3: 0.341513
18:26:44   hits@10: 0.460123
18:26:44   hits@10_50: 0.884174
18:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:44   Epoch 12 begin
18:26:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:52   Epoch 12 end
18:26:52   ------------------------------
18:26:52   average binary cross entropy: 0.3719
18:26:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:52   Epoch 13 begin
18:26:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:26:56   binary cross entropy: 0.346591
18:27:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:00   Epoch 13 end
18:27:00   ------------------------------
18:27:00   average binary cross entropy: 0.371084
18:27:00   Save checkpoint to model_epoch_14.pth
18:27:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:00   Evaluate on valid
18:27:01   mr: 121.959
18:27:01   mrr: 0.32585
18:27:01   hits@1: 0.252556
18:27:01   hits@3: 0.347648
18:27:01   hits@10: 0.47955
18:27:01   hits@10_50: 0.86856
18:27:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:01   Epoch 14 begin
18:27:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:08   binary cross entropy: 0.290749
18:27:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:08   Epoch 14 end
18:27:08   ------------------------------
18:27:08   average binary cross entropy: 0.357851
18:27:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:08   Epoch 15 begin
18:27:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:16   Epoch 15 end
18:27:16   ------------------------------
18:27:16   average binary cross entropy: 0.358165
18:27:16   Save checkpoint to model_epoch_16.pth
18:27:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:16   Evaluate on valid
18:27:17   mr: 119.434
18:27:17   mrr: 0.325092
18:27:17   hits@1: 0.255624
18:27:17   hits@3: 0.343558
18:27:17   hits@10: 0.47137
18:27:17   hits@10_50: 0.874033
18:27:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:17   Epoch 16 begin
18:27:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:20   binary cross entropy: 0.387836
18:27:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:25   Epoch 16 end
18:27:25   ------------------------------
18:27:25   average binary cross entropy: 0.348305
18:27:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:25   Epoch 17 begin
18:27:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:32   binary cross entropy: 0.37912
18:27:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:33   Epoch 17 end
18:27:33   ------------------------------
18:27:33   average binary cross entropy: 0.344585
18:27:33   Save checkpoint to model_epoch_18.pth
18:27:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:33   Evaluate on valid
18:27:33   mr: 154.106
18:27:33   mrr: 0.308326
18:27:33   hits@1: 0.246421
18:27:33   hits@3: 0.325153
18:27:33   hits@10: 0.441718
18:27:33   hits@10_50: 0.827664
18:27:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:33   Epoch 18 begin
18:27:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:41   Epoch 18 end
18:27:41   ------------------------------
18:27:41   average binary cross entropy: 0.342502
18:27:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:41   Epoch 19 begin
18:27:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:45   binary cross entropy: 0.321965
18:27:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:49   Epoch 19 end
18:27:49   ------------------------------
18:27:49   average binary cross entropy: 0.333984
18:27:49   Save checkpoint to model_epoch_20.pth
18:27:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:49   Evaluate on valid
18:27:50   mr: 127.15
18:27:50   mrr: 0.328696
18:27:50   hits@1: 0.255624
18:27:50   hits@3: 0.354806
18:27:50   hits@10: 0.472393
18:27:50   hits@10_50: 0.860975
18:27:50   Load checkpoint from model_epoch_6.pth
18:27:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:50   Evaluate on valid
18:27:51   mr: 85.0767
18:27:51   mrr: 0.351705
18:27:51   hits@1: 0.273006
18:27:51   hits@3: 0.371166
18:27:51   hits@10: 0.52454
18:27:51   hits@10_50: 0.914031
18:27:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:27:51   Evaluate on test
18:27:51   mr: 138.793
18:27:51   mrr: 0.25524
18:27:51   hits@1: 0.129268
18:27:51   hits@3: 0.317073
18:27:51   hits@10: 0.478049
18:27:51   hits@10_50: 0.813355

Process finished with exit code 0
