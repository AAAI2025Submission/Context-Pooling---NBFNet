
(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$ python script/run.py -c config/inductive/wn18rr.yaml --gpus [0] --version v4
00:15:27   Random seed: 1024
00:15:27   Config file: config/inductive/wn18rr.yaml
00:15:27   {'dataset': {'class': 'IndWN18RR',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v4'},
 'model': {'aggregate_func': 'pna',
           'class': 'NBFNet',
           'dependent': False,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/WN18RR_v4_ind/train.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/WN18RR_v4_ind/test.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/WN18RR_v4/train.txt
Downloading https://raw.githubusercontent.com/kkteru/grail/master/data/WN18RR_v4/valid.txt
Processing...
Done!
00:15:30   IndWN18RR dataset
00:15:30   #train: 7940, #valid: 934, #test: 1429
00:15:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:15:32   Epoch 0 begin
Load rspmm extension. This may take a while...
00:15:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:15:35   binary cross entropy: 0.696984
00:16:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:10   binary cross entropy: 0.373285
00:16:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:20   Epoch 0 end
00:16:20   ------------------------------
00:16:20   average binary cross entropy: 0.398067
00:16:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:20   Epoch 1 begin
00:16:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:45   binary cross entropy: 0.361262
00:17:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:02   Epoch 1 end
00:17:02   ------------------------------
00:17:02   average binary cross entropy: 0.35565
00:17:02   Save checkpoint to model_epoch_2.pth
00:17:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:02   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
00:17:05   mr: 229.267
00:17:05   mrr: 0.546009
00:17:05   hits@1: 0.471627
00:17:05   hits@3: 0.593683
00:17:05   hits@10: 0.66167
00:17:05   hits@10_50: 0.88981
00:17:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:05   Epoch 2 begin
00:17:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:23   binary cross entropy: 0.359184
00:17:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:48   Epoch 2 end
00:17:48   ------------------------------
00:17:48   average binary cross entropy: 0.347905
00:17:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:48   Epoch 3 begin
00:17:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:59   binary cross entropy: 0.43371
00:18:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:18:31   Epoch 3 end
00:18:31   ------------------------------
00:18:31   average binary cross entropy: 0.344637
00:18:31   Save checkpoint to model_epoch_4.pth
00:18:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:18:31   Evaluate on valid
00:18:36   mr: 209.852
00:18:36   mrr: 0.550176
00:18:36   hits@1: 0.475375
00:18:36   hits@3: 0.601178
00:18:36   hits@10: 0.664882
00:18:36   hits@10_50: 0.897715
00:18:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:18:36   Epoch 4 begin
00:18:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:18:36   binary cross entropy: 0.434243
00:19:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:11   binary cross entropy: 0.352704
00:19:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:19   Epoch 4 end
00:19:19   ------------------------------
00:19:19   average binary cross entropy: 0.337372
00:19:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:19   Epoch 5 begin
00:19:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:46   binary cross entropy: 0.366993
00:20:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:03   Epoch 5 end
00:20:03   ------------------------------
00:20:03   average binary cross entropy: 0.341079
00:20:03   Save checkpoint to model_epoch_6.pth
00:20:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:03   Evaluate on valid
00:20:06   mr: 185.866
00:20:06   mrr: 0.558361
00:20:06   hits@1: 0.481799
00:20:06   hits@3: 0.614561
00:20:06   hits@10: 0.681477
00:20:06   hits@10_50: 0.914345
00:20:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:06   Epoch 6 begin
00:20:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:23   binary cross entropy: 0.297323
00:20:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:50   Epoch 6 end
00:20:50   ------------------------------
00:20:50   average binary cross entropy: 0.335478
00:20:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:50   Epoch 7 begin
00:20:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:57   binary cross entropy: 0.264743
00:21:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:32   Epoch 7 end
00:21:32   ------------------------------
00:21:32   average binary cross entropy: 0.335181
00:21:32   Save checkpoint to model_epoch_8.pth
00:21:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:32   Evaluate on valid
00:21:34   mr: 186.3
00:21:34   mrr: 0.561559
00:21:34   hits@1: 0.482869
00:21:34   hits@3: 0.616702
00:21:34   hits@10: 0.681477
00:21:34   hits@10_50: 0.912461
00:21:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:34   Epoch 8 begin
00:21:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:35   binary cross entropy: 0.344949
00:22:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:08   binary cross entropy: 0.468216
00:22:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:17   Epoch 8 end
00:22:17   ------------------------------
00:22:17   average binary cross entropy: 0.334181
00:22:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:17   Epoch 9 begin
00:22:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:45   binary cross entropy: 0.334821
00:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:00   Epoch 9 end
00:23:00   ------------------------------
00:23:00   average binary cross entropy: 0.330648
00:23:00   Save checkpoint to model_epoch_10.pth
00:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:00   Evaluate on valid
00:23:03   mr: 178.436
00:23:03   mrr: 0.566685
00:23:03   hits@1: 0.488223
00:23:03   hits@3: 0.622056
00:23:03   hits@10: 0.689507
00:23:03   hits@10_50: 0.913964
00:23:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:03   Epoch 10 begin
00:23:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:21   binary cross entropy: 0.331982
00:23:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:46   Epoch 10 end
00:23:46   ------------------------------
00:23:46   average binary cross entropy: 0.330468
00:23:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:46   Epoch 11 begin
00:23:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:54   binary cross entropy: 0.396018
00:24:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:26   Epoch 11 end
00:24:26   ------------------------------
00:24:26   average binary cross entropy: 0.329582
00:24:26   Save checkpoint to model_epoch_12.pth
00:24:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:26   Evaluate on valid
00:24:30   mr: 191.01
00:24:30   mrr: 0.570634
00:24:30   hits@1: 0.493576
00:24:30   hits@3: 0.622591
00:24:30   hits@10: 0.694861
00:24:30   hits@10_50: 0.905428
00:24:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:30   Epoch 12 begin
00:24:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:30   binary cross entropy: 0.270847
00:25:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:05   binary cross entropy: 0.391621
00:25:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:13   Epoch 12 end
00:25:13   ------------------------------
00:25:13   average binary cross entropy: 0.327089
00:25:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:13   Epoch 13 begin
00:25:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:40   binary cross entropy: 0.296935
00:25:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:57   Epoch 13 end
00:25:57   ------------------------------
00:25:57   average binary cross entropy: 0.324725
00:25:57   Save checkpoint to model_epoch_14.pth
00:25:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:25:57   Evaluate on valid
00:26:00   mr: 178.451
00:26:00   mrr: 0.569028
00:26:00   hits@1: 0.494111
00:26:00   hits@3: 0.619914
00:26:00   hits@10: 0.688972
00:26:00   hits@10_50: 0.913777
00:26:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:26:00   Epoch 14 begin
00:26:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:26:19   binary cross entropy: 0.375923
00:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:26:44   Epoch 14 end
00:26:44   ------------------------------
00:26:44   average binary cross entropy: 0.32337
00:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:26:44   Epoch 15 begin
00:26:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:26:54   binary cross entropy: 0.282194
00:27:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:27:28   Epoch 15 end
00:27:28   ------------------------------
00:27:28   average binary cross entropy: 0.325279
00:27:28   Save checkpoint to model_epoch_16.pth
00:27:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:27:28   Evaluate on valid
00:27:31   mr: 166.231
00:27:31   mrr: 0.565715
00:27:31   hits@1: 0.486617
00:27:31   hits@3: 0.616702
00:27:31   hits@10: 0.689507
00:27:31   hits@10_50: 0.919915
00:27:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:27:31   Epoch 16 begin
00:27:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:27:32   binary cross entropy: 0.337253
00:28:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:28:07   binary cross entropy: 0.361661
00:28:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:28:15   Epoch 16 end
00:28:15   ------------------------------
00:28:15   average binary cross entropy: 0.328666
00:28:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:28:15   Epoch 17 begin
00:28:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:28:41   binary cross entropy: 0.272417
00:29:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:00   Epoch 17 end
00:29:00   ------------------------------
00:29:00   average binary cross entropy: 0.322702
00:29:00   Save checkpoint to model_epoch_18.pth
00:29:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:00   Evaluate on valid
00:29:02   mr: 173.11
00:29:02   mrr: 0.568128
00:29:02   hits@1: 0.491435
00:29:02   hits@3: 0.62045
00:29:02   hits@10: 0.690043
00:29:02   hits@10_50: 0.918687
00:29:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:02   Epoch 18 begin
00:29:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:19   binary cross entropy: 0.358573
00:29:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:46   Epoch 18 end
00:29:46   ------------------------------
00:29:46   average binary cross entropy: 0.323
00:29:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:46   Epoch 19 begin
00:29:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:29:54   binary cross entropy: 0.311901
00:30:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:30:29   Epoch 19 end
00:30:29   ------------------------------
00:30:29   average binary cross entropy: 0.322236
00:30:29   Save checkpoint to model_epoch_20.pth
00:30:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:30:29   Evaluate on valid
00:30:37   mr: 187.493
00:30:37   mrr: 0.564342
00:30:37   hits@1: 0.481799
00:30:37   hits@3: 0.619379
00:30:37   hits@10: 0.695396
00:30:37   hits@10_50: 0.909093
00:30:37   Load checkpoint from model_epoch_12.pth
00:30:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:30:37   Evaluate on valid
00:30:42   mr: 191.01
00:30:42   mrr: 0.570634
00:30:42   hits@1: 0.493576
00:30:42   hits@3: 0.622591
00:30:42   hits@10: 0.694861
00:30:42   hits@10_50: 0.905428
00:30:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:30:42   Evaluate on test
00:30:55   mr: 445.131
00:30:55   mrr: 0.609189
00:30:55   hits@1: 0.53394
00:30:55   hits@3: 0.668299
00:30:55   hits@10: 0.725682
00:30:55   hits@10_50: 0.88311
