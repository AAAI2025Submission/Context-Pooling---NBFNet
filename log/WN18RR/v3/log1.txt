(py38) zhixiang@lily-gpu05:/media/hdd/zhixiang/pycharm/NBFNet$ python script/run.py -c config/inductive/wn18rr.yaml --gpus [0] --version v3                                                                                            [670/1821]
16:39:05   Random seed: 1024
16:39:05   Config file: config/inductive/wn18rr.yaml
16:39:05   {'dataset': {'class': 'IndWN18RR',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v3'},
 'model': {'aggregate_func': 'pna',
           'class': 'NBFNet',
           'dependent': False,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
16:39:05   IndWN18RR dataset
16:39:05   #train: 25901, #valid: 3097, #test: 605
16:39:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:08   Epoch 0 begin
Load rspmm extension. This may take a while...
16:39:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:11   binary cross entropy: 0.70332
16:40:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:26   binary cross entropy: 0.320289
16:41:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:38   binary cross entropy: 0.36578
16:42:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:42:52   binary cross entropy: 0.364732
16:44:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:06   binary cross entropy: 0.30003
16:44:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:08   Epoch 0 end
16:44:08   ------------------------------
16:44:08   average binary cross entropy: 0.347219
16:44:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:08   Epoch 1 begin
16:45:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:18   binary cross entropy: 0.328952
16:46:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:46:32   binary cross entropy: 0.341434
16:47:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:43   binary cross entropy: 0.32695
16:48:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:57   binary cross entropy: 0.321085
16:49:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:05   Epoch 1 end
16:49:05   ------------------------------
16:49:05   average binary cross entropy: 0.321863
16:49:05   Save checkpoint to model_epoch_2.pth
16:49:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:05   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
16:49:25   mr: 413.43
16:49:25   mrr: 0.529285
16:49:25   hits@1: 0.451082
16:49:25   hits@3: 0.579916
16:49:25   hits@10: 0.660801
16:49:25   hits@10_50: 0.939016
16:49:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:25   Epoch 2 begin
16:50:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:33   binary cross entropy: 0.272546
16:51:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:46   binary cross entropy: 0.330522
16:53:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:53:00   binary cross entropy: 0.36942
16:54:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:12   binary cross entropy: 0.238463
16:54:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:23   Epoch 2 end
16:54:23   ------------------------------
16:54:23   average binary cross entropy: 0.315946
16:54:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:23   Epoch 3 begin
16:55:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:55:24   binary cross entropy: 0.331702
16:56:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:38   binary cross entropy: 0.396776
16:57:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:57:51   binary cross entropy: 0.287238
16:59:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:04   binary cross entropy: 0.319062
16:59:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:18   Epoch 3 end
16:59:18   ------------------------------
16:59:18   average binary cross entropy: 0.314073
16:59:18   Save checkpoint to model_epoch_4.pth
16:59:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:18   Evaluate on valid
16:59:41   mr: 380.231
16:59:41   mrr: 0.533463
16:59:41   hits@1: 0.452858
16:59:41   hits@3: 0.584759
16:59:41   hits@10: 0.670165
16:59:41   hits@10_50: 0.943398
16:59:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:41   Epoch 4 begin
17:00:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:00:39   binary cross entropy: 0.280615
17:01:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:01:51   binary cross entropy: 0.296731
17:03:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:05   binary cross entropy: 0.295417
17:04:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:18   binary cross entropy: 0.325382
17:04:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:35   Epoch 4 end
17:04:35   ------------------------------
17:04:35   average binary cross entropy: 0.309261
17:04:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:35   Epoch 5 begin
17:05:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:05:31   binary cross entropy: 0.267034
17:06:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:06:43   binary cross entropy: 0.294874
17:07:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:58   binary cross entropy: 0.372252
17:09:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:09   binary cross entropy: 0.355724
17:09:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:31   Epoch 5 end
17:09:31   ------------------------------
17:09:31   average binary cross entropy: 0.308729
17:09:31   Save checkpoint to model_epoch_6.pth
17:09:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:31   Evaluate on valid
17:09:51   mr: 390.554
17:09:51   mrr: 0.539878
17:09:51   hits@1: 0.457378
17:09:51   hits@3: 0.595253
17:09:51   hits@10: 0.678883
17:09:51   hits@10_50: 0.941405
17:09:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:51   Epoch 6 begin
17:10:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:10:43   binary cross entropy: 0.421843
17:11:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:58   binary cross entropy: 0.361538
17:13:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:13:09   binary cross entropy: 0.326232
17:14:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:14:23   binary cross entropy: 0.332137
17:14:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:14:48   Epoch 6 end
17:14:48   ------------------------------
17:14:48   average binary cross entropy: 0.305252
17:14:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:14:48   Epoch 7 begin
17:15:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:35   binary cross entropy: 0.313773
17:16:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:16:49   binary cross entropy: 0.271902
17:18:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:18:01   binary cross entropy: 0.257876
17:19:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:19:15   binary cross entropy: 0.328058
17:19:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:19:43   Epoch 7 end
17:19:43   ------------------------------
17:19:43   average binary cross entropy: 0.304218
17:19:43   Save checkpoint to model_epoch_8.pth
17:19:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:19:43   Evaluate on valid
17:20:06   mr: 365.775
17:20:06   mrr: 0.541157
17:20:06   hits@1: 0.461253
17:20:06   hits@3: 0.589764
17:20:06   hits@10: 0.676784
17:20:06   hits@10_50: 0.945114
17:20:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:06   Epoch 8 begin
17:20:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:20:49   binary cross entropy: 0.290962
17:22:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:22:03   binary cross entropy: 0.311094
17:23:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:23:15   binary cross entropy: 0.268808
17:24:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:24:29   binary cross entropy: 0.257196
17:25:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:01   Epoch 8 end
17:25:01   ------------------------------
17:25:01   average binary cross entropy: 0.302594
17:25:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:01   Epoch 9 begin
17:25:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:42   binary cross entropy: 0.406278
17:26:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:26:55   binary cross entropy: 0.311306
17:28:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:28:10   binary cross entropy: 0.327975
17:29:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:29:21   binary cross entropy: 0.27735
17:29:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:29:58   Epoch 9 end
17:29:58   ------------------------------
17:29:58   average binary cross entropy: 0.302064
17:29:58   Save checkpoint to model_epoch_10.pth
17:29:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:29:58   Evaluate on valid
17:30:21   mr: 363.793
17:30:21   mrr: 0.542774
17:30:21   hits@1: 0.461253
17:30:21   hits@3: 0.595738
17:30:21   hits@10: 0.677753
17:30:21   hits@10_50: 0.946061
17:30:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:30:21   Epoch 10 begin
17:30:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:30:58   binary cross entropy: 0.308787
17:32:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:32:10   binary cross entropy: 0.211029
17:33:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:33:23   binary cross entropy: 0.205761
17:34:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:34:37   binary cross entropy: 0.332804
17:35:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:16   Epoch 10 end
17:35:16   ------------------------------
17:35:16   average binary cross entropy: 0.301743
17:35:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:16   Epoch 11 begin
17:35:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:48   binary cross entropy: 0.285303
17:37:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:37:02   binary cross entropy: 0.275694
17:38:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:38:16   binary cross entropy: 0.322157
17:39:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:39:28   binary cross entropy: 0.336128
17:40:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:11   Epoch 11 end
17:40:11   ------------------------------
17:40:11   average binary cross entropy: 0.298475
17:40:11   Save checkpoint to model_epoch_12.pth
17:40:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:11   Evaluate on valid
17:40:33   mr: 356.565
17:40:33   mrr: 0.543253
17:40:33   hits@1: 0.462544
17:40:33   hits@3: 0.596545
17:40:33   hits@10: 0.675977
17:40:33   hits@10_50: 0.948076
17:40:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:40:33   Epoch 12 begin
17:41:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:41:04   binary cross entropy: 0.288772
17:42:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:15   binary cross entropy: 0.241064
17:43:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:43:30   binary cross entropy: 0.276396
17:44:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:44:42   binary cross entropy: 0.322589
17:45:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:29   Epoch 12 end
17:45:29   ------------------------------
17:45:29   average binary cross entropy: 0.299153
17:45:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:29   Epoch 13 begin
17:45:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:56   binary cross entropy: 0.320289
17:47:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:47:07   binary cross entropy: 0.379576
17:48:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:48:22   binary cross entropy: 0.274744
17:49:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:49:33   binary cross entropy: 0.24448
17:50:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:50:24   Epoch 13 end
17:50:24   ------------------------------
17:50:24   average binary cross entropy: 0.298471
17:50:24   Save checkpoint to model_epoch_14.pth
17:50:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:50:24   Evaluate on valid
17:50:47   mr: 354.009
17:50:47   mrr: 0.543917
17:50:47   hits@1: 0.462867
17:50:47   hits@3: 0.599128
17:50:47   hits@10: 0.680659
17:50:47   hits@10_50: 0.948423
17:50:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:50:47   Epoch 14 begin
17:51:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:51:11   binary cross entropy: 0.342696
17:52:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:52:22   binary cross entropy: 0.33428
17:53:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:53:36   binary cross entropy: 0.347555
17:54:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:54:47   binary cross entropy: 0.334516
17:55:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:55:44   Epoch 14 end
17:55:44   ------------------------------
17:55:44   average binary cross entropy: 0.296421
17:55:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:55:44   Epoch 15 begin
17:56:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:56:04   binary cross entropy: 0.227196
17:57:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:57:19   binary cross entropy: 0.361427
17:58:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:58:36   binary cross entropy: 0.29472
17:59:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:59:54   binary cross entropy: 0.249187
18:00:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:00:54   Epoch 15 end
18:00:54   ------------------------------
18:00:54   average binary cross entropy: 0.296497
18:00:54   Save checkpoint to model_epoch_16.pth
18:00:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:00:54   Evaluate on valid
18:01:17   mr: 353.592
18:01:17   mrr: 0.542368
18:01:17   hits@1: 0.456894
18:01:17   hits@3: 0.599128
18:01:17   hits@10: 0.685018
18:01:17   hits@10_50: 0.947862
18:01:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:01:17   Epoch 16 begin
18:01:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:01:34   binary cross entropy: 0.251627
18:02:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:02:50   binary cross entropy: 0.264038
18:04:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:04:07   binary cross entropy: 0.246637
18:05:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:05:24   binary cross entropy: 0.313677
18:06:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:06:29   Epoch 16 end
18:06:29   ------------------------------
18:06:29   average binary cross entropy: 0.296013
18:06:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:06:29   Epoch 17 begin
18:06:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:06:41   binary cross entropy: 0.262402
18:07:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:07:57   binary cross entropy: 0.278389
18:09:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:09:13   binary cross entropy: 0.294859
18:10:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:10:31   binary cross entropy: 0.320544
18:11:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:11:40   Epoch 17 end
18:11:40   ------------------------------
18:11:40   average binary cross entropy: 0.294112
18:11:40   Save checkpoint to model_epoch_18.pth
18:11:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:11:40   Evaluate on valid
18:12:02   mr: 357.811
18:12:02   mrr: 0.544628
18:12:02   hits@1: 0.461253
18:12:02   hits@3: 0.599451
18:12:02   hits@10: 0.685179
18:12:02   hits@10_50: 0.947494
18:12:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:12:02   Epoch 18 begin
18:12:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:12:11   binary cross entropy: 0.322015
18:13:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:13:29   binary cross entropy: 0.245282
18:14:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:14:44   binary cross entropy: 0.309996
18:16:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:16:01   binary cross entropy: 0.261212
18:17:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:17:14   Epoch 18 end
18:17:14   ------------------------------
18:17:14   average binary cross entropy: 0.294211
18:17:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:17:14   Epoch 19 begin
18:17:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:17:17   binary cross entropy: 0.272336
18:18:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:18:34   binary cross entropy: 0.25957
18:19:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:19:52   binary cross entropy: 0.268459
18:21:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:21:07   binary cross entropy: 0.355862
18:22:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:22:24   Epoch 19 end
18:22:24   ------------------------------
18:22:24   average binary cross entropy: 0.294176
18:22:24   Save checkpoint to model_epoch_20.pth
18:22:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:22:24   Evaluate on valid
18:22:46   mr: 366.023
18:22:46   mrr: 0.546353
18:22:46   hits@1: 0.464159
18:22:46   hits@3: 0.600258
18:22:46   hits@10: 0.685825
18:22:46   hits@10_50: 0.944723
18:22:46   Load checkpoint from model_epoch_20.pth
18:22:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:22:46   Evaluate on valid
18:23:09   mr: 366.023
18:23:09   mrr: 0.546353
18:23:09   hits@1: 0.464159
18:23:09   hits@3: 0.600258
18:23:09   hits@10: 0.685825
18:23:09   hits@10_50: 0.944723
18:23:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:23:09   Evaluate on test
18:23:13   mr: 235.94
18:23:13   mrr: 0.426748
18:23:13   hits@1: 0.361157
18:23:13   hits@3: 0.457025
18:23:13   hits@10: 0.540496
18:23:13   hits@10_50: 0.920973
