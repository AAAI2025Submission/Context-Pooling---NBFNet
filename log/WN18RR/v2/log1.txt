/home/zhixiang/miniconda3/bin/conda run -n py38 --no-capture-output python /media/hdd/zhixiang/pycharm/NBFNet/script/run.py -c config/inductive/wn18rr.yaml --gpus [0] --version v2
Console output is saving to: C:\Users\Zhixiang Su\PycharmProjects\console_logs
16:34:18   Random seed: 1024
16:34:18   Config file: config/inductive/wn18rr.yaml
16:34:18   {'dataset': {'class': 'IndWN18RR',
             'root': '~/datasets/knowledge_graphs/',
             'version': 'v2'},
 'model': {'aggregate_func': 'pna',
           'class': 'NBFNet',
           'dependent': False,
           'hidden_dims': [32, 32, 32, 32, 32, 32],
           'input_dim': 32,
           'layer_norm': True,
           'message_func': 'distmult',
           'short_cut': True},
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'],
          'num_negative': 32,
          'strict_negative': True},
 'train': {'batch_size': 64, 'gpus': [0], 'log_interval': 100, 'num_epoch': 20}}
16:34:18   IndWN18RR dataset
16:34:18   #train: 15262, #valid: 1838, #test: 441
16:34:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:34:21   Epoch 0 begin
Load rspmm extension. This may take a while...
16:34:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:34:26   binary cross entropy: 0.781291
16:35:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:11   binary cross entropy: 0.314133
16:35:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:57   binary cross entropy: 0.333667
16:36:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:36:14   Epoch 0 end
16:36:14   ------------------------------
16:36:14   average binary cross entropy: 0.367594
16:36:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:36:14   Epoch 1 begin
16:36:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:36:42   binary cross entropy: 0.270755
16:37:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:27   binary cross entropy: 0.421248
16:38:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:01   Epoch 1 end
16:38:01   ------------------------------
16:38:01   average binary cross entropy: 0.3317
16:38:01   Save checkpoint to model_epoch_2.pth
16:38:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:01   Evaluate on valid
/home/zhixiang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525552411/work/aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
16:38:09   mr: 284.064
16:38:09   mrr: 0.550753
16:38:09   hits@1: 0.468716
16:38:09   hits@3: 0.607998
16:38:09   hits@10: 0.681175
16:38:09   hits@10_50: 0.926859
16:38:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:09   Epoch 2 begin
16:38:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:20   binary cross entropy: 0.299108
16:39:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:04   binary cross entropy: 0.362943
16:39:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:49   binary cross entropy: 0.338979
16:39:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:56   Epoch 2 end
16:39:56   ------------------------------
16:39:56   average binary cross entropy: 0.32455
16:39:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:56   Epoch 3 begin
16:40:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:34   binary cross entropy: 0.331305
16:41:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:22   binary cross entropy: 0.284681
16:41:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:46   Epoch 3 end
16:41:46   ------------------------------
16:41:46   average binary cross entropy: 0.322321
16:41:46   Save checkpoint to model_epoch_4.pth
16:41:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:46   Evaluate on valid
16:41:54   mr: 275.67
16:41:54   mrr: 0.55902
16:41:54   hits@1: 0.480141
16:41:54   hits@3: 0.612078
16:41:54   hits@10: 0.688248
16:41:54   hits@10_50: 0.930002
16:41:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:54   Epoch 4 begin
16:42:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:42:14   binary cross entropy: 0.205845
16:42:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:42:59   binary cross entropy: 0.304703
16:43:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:41   Epoch 4 end
16:43:41   ------------------------------
16:43:41   average binary cross entropy: 0.319553
16:43:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:41   Epoch 5 begin
16:43:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:44   binary cross entropy: 0.351158
16:44:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:29   binary cross entropy: 0.257968
16:45:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:13   binary cross entropy: 0.409155
16:45:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:27   Epoch 5 end
16:45:27   ------------------------------
16:45:27   average binary cross entropy: 0.319828
16:45:27   Save checkpoint to model_epoch_6.pth
16:45:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:27   Evaluate on valid
16:45:36   mr: 257.847
16:45:36   mrr: 0.56074
16:45:36   hits@1: 0.479597
16:45:36   hits@3: 0.615343
16:45:36   hits@10: 0.690424
16:45:36   hits@10_50: 0.934021
16:45:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:36   Epoch 6 begin
16:46:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:46:06   binary cross entropy: 0.296757
16:46:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:46:51   binary cross entropy: 0.341886
16:47:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:23   Epoch 6 end
16:47:23   ------------------------------
16:47:23   average binary cross entropy: 0.315578
16:47:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:23   Epoch 7 begin
16:47:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:35   binary cross entropy: 0.370526
16:48:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:20   binary cross entropy: 0.34645
16:49:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:05   binary cross entropy: 0.347184
16:49:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:09   Epoch 7 end
16:49:09   ------------------------------
16:49:09   average binary cross entropy: 0.313166
16:49:09   Save checkpoint to model_epoch_8.pth
16:49:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:09   Evaluate on valid
16:49:18   mr: 250.508
16:49:18   mrr: 0.558662
16:49:18   hits@1: 0.476605
16:49:18   hits@3: 0.611534
16:49:18   hits@10: 0.694233
16:49:18   hits@10_50: 0.935261
16:49:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:18   Epoch 8 begin
16:49:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:49:58   binary cross entropy: 0.296449
16:50:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:42   binary cross entropy: 0.324428
16:51:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:04   Epoch 8 end
16:51:04   ------------------------------
16:51:04   average binary cross entropy: 0.311457
16:51:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:04   Epoch 9 begin
16:51:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:27   binary cross entropy: 0.267723
16:52:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:12   binary cross entropy: 0.294799
16:52:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:51   Epoch 9 end
16:52:51   ------------------------------
16:52:51   average binary cross entropy: 0.312672
16:52:51   Save checkpoint to model_epoch_10.pth
16:52:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:51   Evaluate on valid
16:53:00   mr: 269.278
16:53:00   mrr: 0.566076
16:53:00   hits@1: 0.482862
16:53:00   hits@3: 0.623232
16:53:00   hits@10: 0.699401
16:53:00   hits@10_50: 0.930289
16:53:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:53:00   Epoch 10 begin
16:53:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:53:05   binary cross entropy: 0.283035
16:53:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:53:49   binary cross entropy: 0.306859
16:54:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:34   binary cross entropy: 0.336839
16:54:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:46   Epoch 10 end
16:54:46   ------------------------------
16:54:46   average binary cross entropy: 0.307226
16:54:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:54:46   Epoch 11 begin
16:55:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:55:19   binary cross entropy: 0.343048
16:56:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:03   binary cross entropy: 0.352439
16:56:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:33   Epoch 11 end
16:56:33   ------------------------------
16:56:33   average binary cross entropy: 0.306581
16:56:33   Save checkpoint to model_epoch_12.pth
16:56:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:33   Evaluate on valid
16:56:41   mr: 247.263
16:56:41   mrr: 0.561542
16:56:41   hits@1: 0.478509
16:56:41   hits@3: 0.618063
16:56:41   hits@10: 0.698857
16:56:41   hits@10_50: 0.937214
16:56:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:41   Epoch 12 begin
16:56:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:56:56   binary cross entropy: 0.384051
16:57:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:57:41   binary cross entropy: 0.34332
16:58:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:58:25   binary cross entropy: 0.354161
16:58:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:58:28   Epoch 12 end
16:58:28   ------------------------------
16:58:28   average binary cross entropy: 0.30526
16:58:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:58:28   Epoch 13 begin
16:59:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:10   binary cross entropy: 0.295545
16:59:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:59:54   binary cross entropy: 0.240425
17:00:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:00:14   Epoch 13 end
17:00:14   ------------------------------
17:00:14   average binary cross entropy: 0.306287
17:00:14   Save checkpoint to model_epoch_14.pth
17:00:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:00:14   Evaluate on valid
17:00:23   mr: 235.07
17:00:23   mrr: 0.564434
17:00:23   hits@1: 0.48123
17:00:23   hits@3: 0.618335
17:00:23   hits@10: 0.701306
17:00:23   hits@10_50: 0.939727
17:00:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:00:23   Epoch 14 begin
17:00:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:00:47   binary cross entropy: 0.326928
17:01:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:01:32   binary cross entropy: 0.350806
17:02:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:09   Epoch 14 end
17:02:09   ------------------------------
17:02:09   average binary cross entropy: 0.303397
17:02:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:09   Epoch 15 begin
17:02:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:02:17   binary cross entropy: 0.332624
17:03:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:01   binary cross entropy: 0.231501
17:03:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:46   binary cross entropy: 0.450217
17:03:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:56   Epoch 15 end
17:03:56   ------------------------------
17:03:56   average binary cross entropy: 0.302625
17:03:56   Save checkpoint to model_epoch_16.pth
17:03:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:03:56   Evaluate on valid
17:04:05   mr: 245.836
17:04:05   mrr: 0.565893
17:04:05   hits@1: 0.48259
17:04:05   hits@3: 0.619423
17:04:05   hits@10: 0.701578
17:04:05   hits@10_50: 0.936491
17:04:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:05   Epoch 16 begin
17:04:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:04:39   binary cross entropy: 0.179176
17:05:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:05:24   binary cross entropy: 0.333387
17:05:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:05:51   Epoch 16 end
17:05:51   ------------------------------
17:05:51   average binary cross entropy: 0.303688
17:05:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:05:51   Epoch 17 begin
17:06:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:06:08   binary cross entropy: 0.306694
17:06:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:06:53   binary cross entropy: 0.319548
17:07:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:38   binary cross entropy: 0.223513
17:07:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:38   Epoch 17 end
17:07:38   ------------------------------
17:07:38   average binary cross entropy: 0.301616
17:07:38   Save checkpoint to model_epoch_18.pth
17:07:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:38   Evaluate on valid
17:07:46   mr: 248.491
17:07:46   mrr: 0.565436
17:07:46   hits@1: 0.480413
17:07:46   hits@3: 0.624864
17:07:46   hits@10: 0.698585
17:07:46   hits@10_50: 0.93412
17:07:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:07:46   Epoch 18 begin
17:08:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:08:31   binary cross entropy: 0.241378
17:09:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:16   binary cross entropy: 0.257382
17:09:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:33   Epoch 18 end
17:09:33   ------------------------------
17:09:33   average binary cross entropy: 0.302924
17:09:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:09:33   Epoch 19 begin
17:10:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:10:00   binary cross entropy: 0.192107
17:10:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:10:48   binary cross entropy: 0.215666
17:11:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:23   Epoch 19 end
17:11:23   ------------------------------
17:11:23   average binary cross entropy: 0.303524
17:11:23   Save checkpoint to model_epoch_20.pth
17:11:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:23   Evaluate on valid
17:11:32   mr: 248.044
17:11:32   mrr: 0.56668
17:11:32   hits@1: 0.484222
17:11:32   hits@3: 0.622144
17:11:32   hits@10: 0.70185
17:11:32   hits@10_50: 0.936126
17:11:32   Load checkpoint from model_epoch_20.pth
17:11:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:32   Evaluate on valid
17:11:40   mr: 248.044
17:11:40   mrr: 0.56668
17:11:40   hits@1: 0.484222
17:11:40   hits@3: 0.622144
17:11:40   hits@10: 0.70185
17:11:40   hits@10_50: 0.936126
17:11:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:11:40   Evaluate on test
17:11:41   mr: 155.102
17:11:41   mrr: 0.662095
17:11:41   hits@1: 0.575964
17:11:41   hits@3: 0.730159
17:11:41   hits@10: 0.790249
17:11:41   hits@10_50: 0.896825

Process finished with exit code 0
